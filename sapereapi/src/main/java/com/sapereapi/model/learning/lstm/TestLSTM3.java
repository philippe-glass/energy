package com.sapereapi.model.learning.lstm;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.Map;

import com.sapereapi.log.SapereLogger;
import com.sapereapi.model.energy.SingleNodeStateItem;
import com.sapereapi.model.learning.PredictionScope;
import com.sapereapi.util.SapereUtil;

public class TestLSTM3 {

	static SapereLogger logger = SapereLogger.getInstance();

	public static void main(String[] args) throws IOException {
		/*
		String modelReference = "LSTM_2_12840-Dense_1_11#epochs1";
		modelReference = "LSTM_1_10400-Dense_1_51#epochs1";
		String modelDirectory = "../lstm/dump_models/" + modelReference + "/";
		// Test the directory
		File fModelDirectory = new File(modelDirectory);
		if (!fModelDirectory.exists()) {
			String userDirectory = System.getProperty("user.dir");
			System.err.println("Directoy " + modelDirectory + " does not exists; userDirectory = " + userDirectory);
		}*/
		/*
		 * List<LayerDefinition> listLayerDefinition = new ArrayList<LayerDefinition>();
		 * //LayerDefinition test = new LayerDefinition(0, LSTMLayer.class, 1, 50);
		 * listLayerDefinition.add(new LayerDefinition(LSTMLayer.class, 1, 50));
		 * //listLayerDefinition.add(new LayerDefinition(DropoutLayer.class));
		 * //listLayerDefinition.add(new LayerDefinition(LSTMLayer.class, 50, 10));
		 * //listLayerDefinition.add(new LayerDefinition(DropoutLayer.class));
		 * listLayerDefinition.add(new LayerDefinition(DenseLayer.class, 1));
		 */
		String csvPath = "dump_history_N1.csv";
		String[] listValariables =  { "requested", "produced", "consumed", "provided", "available", "missing" };
		Integer[] horizons = {5,10,30,60};
		/*
		String argX = "X=0.023135818633887244,0.027435853885479818,0.07264815250063882,0.06702380066324,0.05924975355762783,0.05371723781386257,0.05139490215122109,0.05127011394910747,0.05143079129545699,0.051493758476661274|0.027435853885479818,0.07264815250063882,0.06702380066324,0.05924975355762783,0.05371723781386257,0.05139490215122109,0.05127011394910747,0.05143079129545699,0.051493758476661274,0.05142943023010672|0.07264815250063882,0.06702380066324,0.05924975355762783,0.05371723781386257,0.05139490215122109,0.05127011394910747,0.05143079129545699,0.051493758476661274,0.05142943023010672,0.049979537456984066|0.06702380066324,0.05924975355762783,0.05371723781386257,0.05139490215122109,0.05127011394910747,0.05143079129545699,0.051493758476661274,0.05142943023010672,0.049979537456984066,0.004241867616623424|0.05924975355762783,0.05371723781386257,0.05139490215122109,0.05127011394910747,0.05143079129545699,0.051493758476661274,0.05142943023010672,0.049979537456984066,0.004241867616623424,0.0005640541351565106|0.05371723781386257,0.05139490215122109,0.05127011394910747,0.05143079129545699,0.051493758476661274,0.05142943023010672,0.049979537456984066,0.004241867616623424,0.0005640541351565106,0.0005497271314695296|0.05139490215122109,0.05127011394910747,0.05143079129545699,0.051493758476661274,0.05142943023010672,0.049979537456984066,0.004241867616623424,0.0005640541351565106,0.0005497271314695296,0.0006035966653325838|0.05127011394910747,0.05143079129545699,0.051493758476661274,0.05142943023010672,0.049979537456984066,0.004241867616623424,0.0005640541351565106,0.0005497271314695296,0.0006035966653325838,0.0006336117380568128|0.05143079129545699,0.051493758476661274,0.05142943023010672,0.049979537456984066,0.004241867616623424,0.0005640541351565106,0.0005497271314695296,0.0006035966653325838,0.0006336117380568128,0.00042135717843416395|0.051493758476661274,0.05142943023010672,0.049979537456984066,0.004241867616623424,0.0005640541351565106,0.0005497271314695296,0.0006035966653325838,0.0006336117380568128,0.00042135717843416395,0.000376585291912342|0.05142943023010672,0.049979537456984066,0.004241867616623424,0.0005640541351565106,0.0005497271314695296,0.0006035966653325838,0.0006336117380568128,0.00042135717843416395,0.000376585291912342,0.000406958539728745|0.049979537456984066,0.004241867616623424,0.0005640541351565106,0.0005497271314695296,0.0006035966653325838,0.0006336117380568128,0.00042135717843416395,0.000376585291912342,0.000406958539728745,0.000548007891027092|0.004241867616623424,0.0005640541351565106,0.0005497271314695296,0.0006035966653325838,0.0006336117380568128,0.00042135717843416395,0.000376585291912342,0.000406958539728745,0.000548007891027092,0.0007401330104695302|0.0005640541351565106,0.0005497271314695296,0.0006035966653325838,0.0006336117380568128,0.00042135717843416395,0.000376585291912342,0.000406958539728745,0.000548007891027092,0.0007401330104695302,0.0008041747169503424|0.0005497271314695296,0.0006035966653325838,0.0006336117380568128,0.00042135717843416395,0.000376585291912342,0.000406958539728745,0.000548007891027092,0.0007401330104695302,0.0008041747169503424,0.0006990145098878901|0.0006035966653325838,0.0006336117380568128,0.00042135717843416395,0.000376585291912342,0.000406958539728745,0.000548007891027092,0.0007401330104695302,0.0008041747169503424,0.0006990145098878901,0.0005925648724936072|0.0006336117380568128,0.00042135717843416395,0.000376585291912342,0.000406958539728745,0.000548007891027092,0.0007401330104695302,0.0008041747169503424,0.0006990145098878901,0.0005925648724936072,0.0004568165125594468|0.00042135717843416395,0.000376585291912342,0.000406958539728745,0.000548007891027092,0.0007401330104695302,0.0008041747169503424,0.0006990145098878901,0.0005925648724936072,0.0004568165125594468,0.0004699973559514712|0.000376585291912342,0.000406958539728745,0.000548007891027092,0.0007401330104695302,0.0008041747169503424,0.0006990145098878901,0.0005925648724936072,0.0004568165125594468,0.0004699973559514712,0.0003784478023916484|0.000406958539728745,0.000548007891027092,0.0007401330104695302,0.0008041747169503424,0.0006990145098878901,0.0005925648724936072,0.0004568165125594468,0.0004699973559514712,0.0003784478023916484,0.0005606156542716356|0.000548007891027092,0.0007401330104695302,0.0008041747169503424,0.0006990145098878901,0.0005925648724936072,0.0004568165125594468,0.0004699973559514712,0.0003784478023916484,0.0005606156542716356,0.000667638371813396|0.0007401330104695302,0.0008041747169503424,0.0006990145098878901,0.0005925648724936072,0.0004568165125594468,0.0004699973559514712,0.0003784478023916484,0.0005606156542716356,0.000667638371813396,0.0006305314322641118|0.0008041747169503424,0.0006990145098878901,0.0005925648724936072,0.0004568165125594468,0.0004699973559514712,0.0003784478023916484,0.0005606156542716356,0.000667638371813396,0.0006305314322641118,0.000540342944054556|0.0006990145098878901,0.0005925648724936072,0.0004568165125594468,0.0004699973559514712,0.0003784478023916484,0.0005606156542716356,0.000667638371813396,0.0006305314322641118,0.000540342944054556,0.0002940617506753205|0.0005925648724936072,0.0004568165125594468,0.0004699973559514712,0.0003784478023916484,0.0005606156542716356,0.000667638371813396,0.0006305314322641118,0.000540342944054556,0.0002940617506753205,0.00033102542018773745|0.0004568165125594468,0.0004699973559514712,0.0003784478023916484,0.0005606156542716356,0.000667638371813396,0.0006305314322641118,0.000540342944054556,0.0002940617506753205,0.00033102542018773745,0.0003290196396715586|0.0004699973559514712,0.0003784478023916484,0.0005606156542716356,0.000667638371813396,0.0006305314322641118,0.000540342944054556,0.0002940617506753205,0.00033102542018773745,0.0003290196396715586,0.0003755107666358181|0.0003784478023916484,0.0005606156542716356,0.000667638371813396,0.0006305314322641118,0.000540342944054556,0.0002940617506753205,0.00033102542018773745,0.0003290196396715586,0.0003755107666358181,0.002329069354374354|0.0005606156542716356,0.000667638371813396,0.0006305314322641118,0.000540342944054556,0.0002940617506753205,0.00033102542018773745,0.0003290196396715586,0.0003755107666358181,0.002329069354374354,0.0027382485796745813|0.000667638371813396,0.0006305314322641118,0.000540342944054556,0.0002940617506753205,0.00033102542018773745,0.0003290196396715586,0.0003755107666358181,0.002329069354374354,0.0027382485796745813,0.0027525039483431296|0.0006305314322641118,0.000540342944054556,0.0002940617506753205,0.00033102542018773745,0.0003290196396715586,0.0003755107666358181,0.002329069354374354,0.0027382485796745813,0.0027525039483431296,0.003094346256314537|0.000540342944054556,0.0002940617506753205,0.00033102542018773745,0.0003290196396715586,0.0003755107666358181,0.002329069354374354,0.0027382485796745813,0.0027525039483431296,0.003094346256314537,0.003280024224097835|0.0002940617506753205,0.00033102542018773745,0.0003290196396715586,0.0003755107666358181,0.002329069354374354,0.0027382485796745813,0.0027525039483431296,0.003094346256314537,0.003280024224097835,0.0034950725494394454|0.00033102542018773745,0.0003290196396715586,0.0003755107666358181,0.002329069354374354,0.0027382485796745813,0.0027525039483431296,0.003094346256314537,0.003280024224097835,0.0034950725494394454,0.0035398444359612657|0.0003290196396715586,0.0003755107666358181,0.002329069354374354,0.0027382485796745813,0.0027525039483431296,0.003094346256314537,0.003280024224097835,0.0034950725494394454,0.0035398444359612657,0.003422721180820182|0.0003755107666358181,0.002329069354374354,0.0027382485796745813,0.0027525039483431296,0.003094346256314537,0.003280024224097835,0.0034950725494394454,0.0035398444359612657,0.003422721180820182,0.0033351831882927167|0.002329069354374354,0.0027382485796745813,0.0027525039483431296,0.003094346256314537,0.003280024224097835,0.0034950725494394454,0.0035398444359612657,0.003422721180820182,0.0033351831882927167,0.0031548778468920395|0.0027382485796745813,0.0027525039483431296,0.003094346256314537,0.003280024224097835,0.0034950725494394454,0.0035398444359612657,0.003422721180820182,0.0033351831882927167,0.0031548778468920395,0.0031644769393623165|0.0027525039483431296,0.003094346256314537,0.003280024224097835,0.0034950725494394454,0.0035398444359612657,0.003422721180820182,0.0033351831882927167,0.0031548778468920395,0.0031644769393623165,0.002853294419281052|0.003094346256314537,0.003280024224097835,0.0034950725494394454,0.0035398444359612657,0.003422721180820182,0.0033351831882927167,0.0031548778468920395,0.0031644769393623165,0.002853294419281052,0.0039657146205568285|0.003280024224097835,0.0034950725494394454,0.0035398444359612657,0.003422721180820182,0.0033351831882927167,0.0031548778468920395,0.0031644769393623165,0.002853294419281052,0.0039657146205568285,0.00836138262176001|0.0034950725494394454,0.0035398444359612657,0.003422721180820182,0.0033351831882927167,0.0031548778468920395,0.0031644769393623165,0.002853294419281052,0.0039657146205568285,0.00836138262176001,0.007516805754412376|0.0035398444359612657,0.003422721180820182,0.0033351831882927167,0.0031548778468920395,0.0031644769393623165,0.002853294419281052,0.0039657146205568285,0.00836138262176001,0.007516805754412376,0.0005556012029811919|0.003422721180820182,0.0033351831882927167,0.0031548778468920395,0.0031644769393623165,0.002853294419281052,0.0039657146205568285,0.00836138262176001,0.007516805754412376,0.0005556012029811919,0.0003065262438829968|0.0033351831882927167,0.0031548778468920395,0.0031644769393623165,0.002853294419281052,0.0039657146205568285,0.00836138262176001,0.007516805754412376,0.0005556012029811919,0.0003065262438829968,0.0003378307469390548|0.0031548778468920395,0.0031644769393623165,0.002853294419281052,0.0039657146205568285,0.00836138262176001,0.007516805754412376,0.0005556012029811919,0.0003065262438829968,0.0003378307469390548,0.00035108322534951365|0.0031644769393623165,0.002853294419281052,0.0039657146205568285,0.00836138262176001,0.007516805754412376,0.0005556012029811919,0.0003065262438829968,0.0003378307469390548,0.00035108322534951365,0.0004073167148209208|0.002853294419281052,0.0039657146205568285,0.00836138262176001,0.007516805754412376,0.0005556012029811919,0.0003065262438829968,0.0003378307469390548,0.00035108322534951365,0.0004073167148209208,0.00043425148175244704|0.0039657146205568285,0.00836138262176001,0.007516805754412376,0.0005556012029811919,0.0003065262438829968,0.0003378307469390548,0.00035108322534951365,0.0004073167148209208,0.00043425148175244704,0.00026433321802483284|0.00836138262176001,0.007516805754412376,0.0005556012029811919,0.0003065262438829968,0.0003378307469390548,0.00035108322534951365,0.0004073167148209208,0.00043425148175244704,0.00026433321802483284,0.00035480824630812827|0.007516805754412376,0.0005556012029811919,0.0003065262438829968,0.0003378307469390548,0.00035108322534951365,0.0004073167148209208,0.00043425148175244704,0.00026433321802483284,0.00035480824630812827,0.0004918460365741176|0.0005556012029811919,0.0003065262438829968,0.0003378307469390548,0.00035108322534951365,0.0004073167148209208,0.00043425148175244704,0.00026433321802483284,0.00035480824630812827,0.0004918460365741176,0.0005902725519036905|0.0003065262438829968,0.0003378307469390548,0.00035108322534951365,0.0004073167148209208,0.00043425148175244704,0.00026433321802483284,0.00035480824630812827,0.0004918460365741176,0.0005902725519036905,0.0008189315307479336|0.0003378307469390548,0.00035108322534951365,0.0004073167148209208,0.00043425148175244704,0.00026433321802483284,0.00035480824630812827,0.0004918460365741176,0.0005902725519036905,0.0008189315307479336,0.000840851846389018|0.00035108322534951365,0.0004073167148209208,0.00043425148175244704,0.00026433321802483284,0.00035480824630812827,0.0004918460365741176,0.0005902725519036905,0.0008189315307479336,0.000840851846389018,0.0007067510918788589|0.0004073167148209208,0.00043425148175244704,0.00026433321802483284,0.00035480824630812827,0.0004918460365741176,0.0005902725519036905,0.0008189315307479336,0.000840851846389018,0.0007067510918788589,0.0006300299871350671|0.00043425148175244704,0.00026433321802483284,0.00035480824630812827,0.0004918460365741176,0.0005902725519036905,0.0008189315307479336,0.000840851846389018,0.0007067510918788589,0.0006300299871350671,0.00045481073204326795|0.00026433321802483284,0.00035480824630812827,0.0004918460365741176,0.0005902725519036905,0.0008189315307479336,0.000840851846389018,0.0007067510918788589,0.0006300299871350671,0.00045481073204326795,0.0005091817110353686|0.00035480824630812827,0.0004918460365741176,0.0005902725519036905,0.0008189315307479336,0.000840851846389018,0.0007067510918788589,0.0006300299871350671,0.00045481073204326795,0.0005091817110353686,0.00042006774810233495|0.0004918460365741176,0.0005902725519036905,0.0008189315307479336,0.000840851846389018,0.0007067510918788589,0.0006300299871350671,0.00045481073204326795,0.0005091817110353686,0.00042006774810233495,0.0005796705691753223|0.0005902725519036905,0.0008189315307479336,0.000840851846389018,0.0007067510918788589,0.0006300299871350671,0.00045481073204326795,0.0005091817110353686,0.00042006774810233495,0.0005796705691753223,0.0006860485715511691|0.0008189315307479336,0.000840851846389018,0.0007067510918788589,0.0006300299871350671,0.00045481073204326795,0.0005091817110353686,0.00042006774810233495,0.0005796705691753223,0.0006860485715511691,0.0006389127294209977|0.000840851846389018,0.0007067510918788589,0.0006300299871350671,0.00045481073204326795,0.0005091817110353686,0.00042006774810233495,0.0005796705691753223,0.0006860485715511691,0.0006389127294209977,0.0005493689563773555|0.0007067510918788589,0.0006300299871350671,0.00045481073204326795,0.0005091817110353686,0.00042006774810233495,0.0005796705691753223,0.0006860485715511691,0.0006389127294209977,0.0005493689563773555,0.0003222859479386775|0.0006300299871350671,0.00045481073204326795,0.0005091817110353686,0.00042006774810233495,0.0005796705691753223,0.0006860485715511691,0.0006389127294209977,0.0005493689563773555,0.0003222859479386775,0.00033475044114635207|0.00045481073204326795,0.0005091817110353686,0.00042006774810233495,0.0005796705691753223,0.0006860485715511691,0.0006389127294209977,0.0005493689563773555,0.0003222859479386775,0.00033475044114635207,0.0003450658838009806|0.0005091817110353686,0.00042006774810233495,0.0005796705691753223,0.0006860485715511691,0.0006389127294209977,0.0005493689563773555,0.0003222859479386775,0.00033475044114635207,0.0003450658838009806,0.0003815997432027856|0.00042006774810233495,0.0005796705691753223,0.0006860485715511691,0.0006389127294209977,0.0005493689563773555,0.0003222859479386775,0.00033475044114635207,0.0003450658838009806,0.0003815997432027856,0.0004148383917565862|0.0005796705691753223,0.0006860485715511691,0.0006389127294209977,0.0005493689563773555,0.0003222859479386775,0.00033475044114635207,0.0003450658838009806,0.0003815997432027856,0.0004148383917565862,0.0002362522907983465|0.0006860485715511691,0.0006389127294209977,0.0005493689563773555,0.0003222859479386775,0.00033475044114635207,0.0003450658838009806,0.0003815997432027856,0.0004148383917565862,0.0002362522907983465,0.00018933135372347677|0.0006389127294209977,0.0005493689563773555,0.0003222859479386775,0.00033475044114635207,0.0003450658838009806,0.0003815997432027856,0.0004148383917565862,0.0002362522907983465,0.00018933135372347677,0.0004580343078728396|0.0005493689563773555,0.0003222859479386775,0.00033475044114635207,0.0003450658838009806,0.0003815997432027856,0.0004148383917565862,0.0002362522907983465,0.00018933135372347677,0.0004580343078728396,0.0005793840291015828|0.0003222859479386775,0.00033475044114635207,0.0003450658838009806,0.0003815997432027856,0.0004148383917565862,0.0002362522907983465,0.00018933135372347677,0.0004580343078728396,0.0005793840291015828,0.0007851198020466556|0.00033475044114635207,0.0003450658838009806,0.0003815997432027856,0.0004148383917565862,0.0002362522907983465,0.00018933135372347677,0.0004580343078728396,0.0005793840291015828,0.0007851198020466556,0.0008060372274296505|0.0003450658838009806,0.0003815997432027856,0.0004148383917565862,0.0002362522907983465,0.00018933135372347677,0.0004580343078728396,0.0005793840291015828,0.0007851198020466556,0.0008060372274296505,0.0006639849858732175|0.0003815997432027856,0.0004148383917565862,0.0002362522907983465,0.00018933135372347677,0.0004580343078728396,0.0005793840291015828,0.0007851198020466556,0.0008060372274296505,0.0006639849858732175,0.000569928206668173|0.0004148383917565862,0.0002362522907983465,0.00018933135372347677,0.0004580343078728396,0.0005793840291015828,0.0007851198020466556,0.0008060372274296505,0.0006639849858732175,0.000569928206668173,0.00042458075426373386|0.0002362522907983465,0.00018933135372347677,0.0004580343078728396,0.0005793840291015828,0.0007851198020466556,0.0008060372274296505,0.0006639849858732175,0.000569928206668173,0.00042458075426373386,0.0004741521870206943|0.00018933135372347677,0.0004580343078728396,0.0005793840291015828,0.0007851198020466556,0.0008060372274296505,0.0006639849858732175,0.000569928206668173,0.00042458075426373386,0.0004741521870206943,0.00038553966921670707|0.0004580343078728396,0.0005793840291015828,0.0007851198020466556,0.0008060372274296505,0.0006639849858732175,0.000569928206668173,0.00042458075426373386,0.0004741521870206943,0.00038553966921670707,0.0005470766357874371|0.0005793840291015828,0.0007851198020466556,0.0008060372274296505,0.0006639849858732175,0.000569928206668173,0.00042458075426373386,0.0004741521870206943,0.00038553966921670707,0.0005470766357874371,0.0006623373804492145|0.0007851198020466556,0.0008060372274296505,0.0006639849858732175,0.000569928206668173,0.00042458075426373386,0.0004741521870206943,0.00038553966921670707,0.0005470766357874371,0.0006623373804492145,0.0006230813903468808|0.0008060372274296505,0.0006639849858732175,0.000569928206668173,0.00042458075426373386,0.0004741521870206943,0.00038553966921670707,0.0005470766357874371,0.0006623373804492145,0.0006230813903468808,0.000545429030363434|0.0006639849858732175,0.000569928206668173,0.00042458075426373386,0.0004741521870206943,0.00038553966921670707,0.0005470766357874371,0.0006623373804492145,0.0006230813903468808,0.000545429030363434,0.0003207099775331089|0.000569928206668173,0.00042458075426373386,0.0004741521870206943,0.00038553966921670707,0.0005470766357874371,0.0006623373804492145,0.0006230813903468808,0.000545429030363434,0.0003207099775331089,0.0003189907370906714|0.00042458075426373386,0.0004741521870206943,0.00038553966921670707,0.0005470766357874371,0.0006623373804492145,0.0006230813903468808,0.000545429030363434,0.0003207099775331089,0.0003189907370906714,0.0003371143967547032|0.0004741521870206943,0.00038553966921670707,0.0005470766357874371,0.0006623373804492145,0.0006230813903468808,0.000545429030363434,0.0003207099775331089,0.0003189907370906714,0.0003371143967547032,0.0003722871908062482";
		String argY = "Y=0.05142943023010672|0.049979537456984066|0.004241867616623424|0.0005640541351565106|0.0005497271314695296|0.0006035966653325838|0.0006336117380568128|0.00042135717843416395|0.000376585291912342|0.000406958539728745|0.000548007891027092|0.0007401330104695302|0.0008041747169503424|0.0006990145098878901|0.0005925648724936072|0.0004568165125594468|0.0004699973559514712|0.0003784478023916484|0.0005606156542716356|0.000667638371813396|0.0006305314322641118|0.000540342944054556|0.0002940617506753205|0.00033102542018773745|0.0003290196396715586|0.0003755107666358181|0.002329069354374354|0.0027382485796745813|0.0027525039483431296|0.003094346256314537|0.003280024224097835|0.0034950725494394454|0.0035398444359612657|0.003422721180820182|0.0033351831882927167|0.0031548778468920395|0.0031644769393623165|0.002853294419281052|0.0039657146205568285|0.00836138262176001|0.007516805754412376|0.0005556012029811919|0.0003065262438829968|0.0003378307469390548|0.00035108322534951365|0.0004073167148209208|0.00043425148175244704|0.00026433321802483284|0.00035480824630812827|0.0004918460365741176|0.0005902725519036905|0.0008189315307479336|0.000840851846389018|0.0007067510918788589|0.0006300299871350671|0.00045481073204326795|0.0005091817110353686|0.00042006774810233495|0.0005796705691753223|0.0006860485715511691|0.0006389127294209977|0.0005493689563773555|0.0003222859479386775|0.00033475044114635207|0.0003450658838009806|0.0003815997432027856|0.0004148383917565862|0.0002362522907983465|0.00018933135372347677|0.0004580343078728396|0.0005793840291015828|0.0007851198020466556|0.0008060372274296505|0.0006639849858732175|0.000569928206668173|0.00042458075426373386|0.0004741521870206943|0.00038553966921670707|0.0005470766357874371|0.0006623373804492145|0.0006230813903468808|0.000545429030363434|0.0003207099775331089|0.0003189907370906714|0.0003371143967547032|0.0003722871908062482|0.0004091792253002272";
		String argIndexes = "INDEXES=2023-01-15 17:14:00,2023-01-15 17:15:00,2023-01-15 17:16:00,2023-01-15 17:17:00,2023-01-15 17:18:00,2023-01-15 17:19:00,2023-01-15 17:20:00,2023-01-15 17:21:00,2023-01-15 17:22:00,2023-01-15 17:23:00,2023-01-15 17:24:00,2023-01-15 17:25:00,2023-01-15 17:26:00,2023-01-15 17:27:00,2023-01-15 17:28:00,2023-01-15 17:29:00,2023-01-15 17:30:00,2023-01-15 17:31:00,2023-01-15 17:32:00,2023-01-15 17:33:00,2023-01-15 17:34:00,2023-01-15 17:35:00,2023-01-15 17:36:00,2023-01-15 17:37:00,2023-01-15 17:38:00,2023-01-15 17:39:00,2023-01-15 17:40:00,2023-01-15 17:41:00,2023-01-15 17:42:00,2023-01-15 17:43:00,2023-01-15 17:44:00,2023-01-15 17:45:00,2023-01-15 17:46:00,2023-01-15 17:47:00,2023-01-15 17:48:00,2023-01-15 17:49:00,2023-01-15 17:50:00,2023-01-15 17:51:00,2023-01-15 17:52:00,2023-01-15 17:53:00,2023-01-15 17:54:00,2023-01-15 17:55:00,2023-01-15 17:56:00,2023-01-15 17:57:00,2023-01-15 17:58:00,2023-01-15 17:59:00,2023-01-15 18:00:00,2023-01-15 18:01:00,2023-01-15 18:02:00,2023-01-15 18:03:00,2023-01-15 18:04:00,2023-01-15 18:05:00,2023-01-15 18:06:00,2023-01-15 18:07:00,2023-01-15 18:08:00,2023-01-15 18:09:00,2023-01-15 18:10:00,2023-01-15 18:11:00,2023-01-15 18:12:00,2023-01-15 18:13:00,2023-01-15 18:14:00,2023-01-15 18:15:00,2023-01-15 18:16:00,2023-01-15 18:17:00,2023-01-15 18:18:00,2023-01-15 18:19:00,2023-01-15 18:20:00,2023-01-15 18:21:00,2023-01-15 18:22:00,2023-01-15 18:23:00,2023-01-15 18:24:00,2023-01-15 18:25:00,2023-01-15 18:26:00,2023-01-15 18:27:00,2023-01-15 18:28:00,2023-01-15 18:29:00,2023-01-15 18:30:00,2023-01-15 18:31:00,2023-01-15 18:32:00,2023-01-15 18:33:00,2023-01-15 18:34:00,2023-01-15 18:35:00,2023-01-15 18:36:00,2023-01-15 18:37:00,2023-01-15 18:38:00,2023-01-15 18:39:00,2023-01-15 18:40:00";
		*/
		int nbOfItems = 87;
		int depthX = 10;
		int depthY = 10;
		String nodeName = "N1";
		// Call python script predict.py
		try {
			List<SingleNodeStateItem> nodeStateItems = SingleNodeStateItem.loadFromCsvFile(csvPath, ",", listValariables);
			//int len = nodeStateItems.size();
			SingleNodeStateItem lastItem = nodeStateItems.get(nodeStateItems.size()-1);
			Date initDate = lastItem.getDate();
			Map<String, String> mapParams = SingleNodeStateItem.preparePredictParameters2(nodeStateItems, initDate, depthX, depthY, nbOfItems, nodeName, PredictionScope.NODE, "consumed", horizons, logger);
			for(String param : mapParams.keySet()) {
				System.out.println(param + " = " + mapParams.get(param));
			}
			String programDir = System.getProperty("user.dir") + "\\..\\lstm\\";
			String programPath = programDir + "predict.py";
			List<String> result = SapereUtil.callPythonScript(programPath, mapParams);
			List<Double> predictedValues = new ArrayList<Double>();
			for(String line : result) {
				if(line.startsWith("list_predicted ")) {
					String sPredicted = line.replace("list_predicted ", "");
					sPredicted = sPredicted.replace(" ", "");
					sPredicted = sPredicted.replace("[", "");
					sPredicted = sPredicted.replace("]", "");
					String[] sArrayPredicted = sPredicted.split(",");
					for(String nextPredicted : sArrayPredicted) {
						//System.out.println("nextPredicted = " +  nextPredicted);
						predictedValues.add(Double.valueOf(nextPredicted));
					}
				}
			}
			System.out.println("predictedValues = " +  predictedValues);
		} catch (Throwable e) {
			logger.error(e);
		}
	}
}
